<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="bimwook.com" />
    <meta name="woo:version" content="2024-10-02" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no" />
    <title>Markdown-Viewer - bimwook.com</title>
    <style type="text/css">
      * { box-sizing: border-box; }
      html {
        margin:0;
        padding:0;
        height: 100%;
        font-size: 16px;
        background-color: gray;
      }
      body {
        margin:0 auto;
        padding:0;
        width: 100%;
        min-height:100%;
        max-width: 980px;
        font-size: 1em;
        line-height: 1.8;
        overflow: auto;
        background-color: white;
        font-family: tahoma, verdana, "Microsoft Yahei";
      }
      img {
        margin: 0 auto;
        display:block;
        max-width: 88%;
        overflow: hidden;
        border-radius: 5px;
        background-color: rgba(0,0,0,0.05);
      }
      h1,h2,h3,h4,h5,h6 {
        margin:0;
        padding: 8px 32px;
        text-align: left;
      }
      h1 { font-size: 2.0em; border-bottom: solid 1px #EAEAEA; }
      h2 { font-size: 1.8em; }
      h3 { font-size: 1.6em; }
      h4 { font-size: 1.4em; }
      h5 { font-size: 1.2em; }
      h6 { font-size: 1.0em; }
      a {
        color: #006291;
        text-decoration: none;
        transition: all 0.3s ease-out;
      }
      a:link { color: #006291; }
      a:visited { color: #006291; }
      a:hover { text-decoration: none; color: #FF6633; }
      em { font-style: normal; font-weight: normal; }
      hr {
        margin: 0;
        padding: 0;
        border: none;
        height: 1px;
        background: #EAEAEA;
      }
      p { margin: 0.8em 0; padding: 0; text-indent: 2em; }
      ul {
        margin: 1em;
        padding: 0;
        padding-left: 2.5em;
        list-style-type: disc;
      }
      li {
        margin:0;
        padding:0;
      }
      dl, dd {
        margin:0;
        padding:0;
      }
      section {
        margin: 0;
        padding: 0;
        display: block;
      }
      @keyframes mx-load {
        0% { background-color: rgb(200, 200, 200); }
        50% { background-color: rgb(210, 210, 210); }
        100% { background-color: rgb(200, 200, 200); }
      }
      .mx-load {
        width: 100%;
        height: auto;
        margin: 1em auto;
        background-image: url(/media/loading.svg);
        background-repeat: no-repeat;
        background-position: center center;
        background-size: 3rem 3rem;
        animation-name: mx-load;
        animation-duration: 1s;
        animation-iteration-count: infinite;
      }
      .mx-error {
        width: auto;
        height: auto;
        margin: 1em auto;
        background-color: rgba(250,250,250,0.8);
      }
      .mx-normal {
        width: auto;
        cursor: pointer;
        background-color: rgba(250,250,250,1);
      }
      .md-blocks {
        margin: 1em 2em;
        padding: 0.5em 1em;
        text-indent: 0;
        border-left: solid 5px silver;
        background-color: #EEEEEE;
      }
      .md-label {
        color: gray;
        padding: 4px;
        font-size: 0.9em;
        border: solid 1px silver;
        border-radius: 3px;
        background-color: #EEEEEE;
        vertical-align: middle;
      }
      .md-italic {
        font-style: italic;
      }
      .md-media-audio {
        display:block;
      }
      .md-media-video {
        width: 100%;
        display:block;
      }
      .mx-bar {
        padding: 0 16px;
        color: rgba(0,0,0,0.618);
        height: 48px;
        display: flex;
        gap: 8px;
        flex-direction: row;
        flex-wrap: nowrap;
        align-items: center;
        background-color: rgba(200,200,200,0.618);
      }
      .mx-row {
        margin: 0;
        padding: 8px 16px;
        display: flex;
        gap: 8px;
        flex-direction: row;
        flex-wrap: nowrap;
        align-items: center;
      }
      .mx-auto {
        flex: 1;
      }
      .mx-center {
        margin: 0;
        color: silver;
        padding: 1em;
        display: flex;
        flex-direction: column;
        flex-wrap: nowrap;
        align-items: center;
      }
      .mx-text-center {
        width: 100%;
        margin: 0;
        padding: 0;
        display: block;
        text-align: center;
      }
      .mx-small {
        color: silver;
        font-size: 0.875em;
      }
      .mx-content {
        color: #646464;
        padding: 32px 96px;
        font-size: 1rem;
        text-align: justify;
        line-height: 1.618;
        background-color: white;
        overflow: hidden;
      }
      .mx-link {
        transition: all 0.3s ease-out;
      }
      #data { display: none; }
      @media screen and (max-width: 639px) {
        h1,h2,h3,h4,h5,h6 { text-align: left; }
        .mx-content{ padding: 2em 4em; overflow: hidden; }
        #mono { display: none; }
        #version { display: none; }
      }
      @media screen and (max-width: 479px) {
        .mx-content{ padding: 2em; overflow: hidden; }
      }
      @media print {
        h2 { page-break-before:always; }
        .mx-bar { display: none; }
        .mx-content{ padding: 0; }
      }
    </style>
    <script type="text/javascript" src="./cdn/woo.js"></script>
    <script type="text/javascript" src="./cdn/marked.js"></script>
    <script type="text/javascript" src="./cdn/base64.js"></script>
  </head>
  <body>
    <section class="mx-row mx-small">
      <em> woo.omuen.com | </em>
      <em id="title" class="mx-auto"></em>
    </section>
    <hr />
    <article id="content" class="mx-content">
      <p>　</p>
    </article>
    <hr />
    <section class="mx-row">
      <div id="mono" class="mx-small mx-auto"> 因为凡祈求的，就得着；寻找的，就寻见；叩门的，就给他开门。 </div>
      <div class="mx-small"> Since 2007, MIT </div>
    </section>
    <script type="text/javascript">
      (()=>{
        const web = window.Web;
        const marked = window.Marked;
        const base64 = window.Base64;
        const $ = (id)=>{ return document.querySelector(id) };
        const woo = {
          rowid: "",
          title(data){
            let regex = /^(#{1,6}) {0,}([^\n]+?) *#* *(?:\n+|$)/;
            let t="无题";
            let min = 7;
            let lines = (data||"").split("\n");
            for(let i=0; i<lines.length; i++){
              let line = (lines[i]||"").replace(/(^\s*)|(\s*$)/g, "");
              let mcs = line.match(regex);
              if(!mcs) continue;
              let l = mcs[1].length;
              if(l<min){ t = mcs[2]; min = l;}
            }
            return t;
          },
          throttle(action, delay){
            let me = this;
            let timer=null;
            return ()=>{
              let args = arguments;
              window.clearTimeout(timer);
              timer = window.setTimeout( ()=>{ action.apply(me, args) }, delay);
            }
          },
          encode(s){
            return (s||"").replace(/\r/g, "").replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/"/g, "&quot;");
          }
        };
        let media = {
          items: [],
          clear(){
            items = [];
          },
          run(){
            let me = this;
            let top = (document.documentElement.scrollTop || document.body.scrollTop);
            let line = top + document.documentElement.clientHeight;
            let rest = [];
            while(this.items.length>0){
              let img = this.items.pop();
              let t = img.offsetTop;
              if((t>=top) && (t<=line)) {
                img.onload = function(){
                  let src = this.attributes["data-src"];
                  if(this.src.indexOf(src.value)>-1){
                    this.className = "mx-normal";
                    this.onclick = function(){ window.open(this.src) };
                  }
                  else {
                    let g = this;
                    this.style.cursor = "pointer";
                    if(this.src.indexOf("/media/text.svg")>-1){
                      this.className = "mx-error";
                    }
                    this.onclick = ()=>{
                      g.src = "/media/nil.svg";
                      window.setTimeout(()=>{
                        g.className = "mx-load";
                      }, 0);
                      window.setTimeout(()=>{
                        g.className = "mx-load";
                        g.src = src.value;
                      }, 300);
                    };
                  }
                };
                img.onerror = function(){
                  this.onclick = null;
                  this.src="/media/err.svg";
                }
                img.className = "mx-load";
                img.src = (img.attributes["data-src"]||{name:"",value:"/media/nil.svg"}).value;
              }
              else{
                rest.push(img);
              }
            }
            me.items = rest.reverse();
            if(me.items.length==0) {
              window.onscroll = null;
            }
          },
          load(id){
            let me = this;
            let nodes = $(id).getElementsByTagName("img");
            let list = [];
            for(let i=0; i<nodes.length; i++){
              list.push(nodes[i]);
            }
            list.reverse();
            for(let i=0; i<list.length; i++){
              let img = list[i];
              img.className = "o-load";
              me.items.push(img);
            }
            window.onscroll = woo.throttle( ()=>{ me.run() }, 500);
            this.run();
          }
        }
        web.get("./data/main.md").then((o)=>{
          let title = woo.title(o.text);
          let html = marked.build(woo.encode(o.text));
          document.title = title;
          $("#title").innerText = (title);
          $("#content").innerHTML = (html.replace(/<img src=/g, "<img data-src=") );
          media.load("#content");
        });
      })();
    </script>
  </body>
</html>
